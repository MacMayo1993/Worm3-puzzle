:root{--paper-warm: #f5f1e3;--paper-cream: #fefae0;--paper-aged: #f2e8cf;--paper-shadow: #e8e2d0;--burnt-orange: #bc6c25;--burnt-orange-light: #dda15e;--avocado: #606c38;--avocado-dark: #283618;--mustard: #d4a373;--rust: #9c4a1a;--ink-dark: #582f0e;--ink-medium: #7f5539;--ink-light: #9c6644;--tunnel-glow: #dda15e;--tunnel-core: #bc6c25;--safe-area-inset-top: env(safe-area-inset-top, 0px);--safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);--safe-area-inset-left: env(safe-area-inset-left, 0px);--safe-area-inset-right: env(safe-area-inset-right, 0px)}html,body{margin:0;padding:0;overflow:hidden}body{background:#000;font-family:Georgia,Times New Roman,serif}.full-screen{width:100vw;height:100vh;height:100dvh;margin:0;padding:0;padding-bottom:var(--safe-area-inset-bottom);overflow:hidden;background:#000;color:var(--ink-dark);font-family:Georgia,serif;position:relative;box-sizing:border-box}.canvas-container{width:100%;height:100%;position:absolute;top:0;left:0}.ui-layer{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;display:flex;flex-direction:column;justify-content:space-between;padding:1.5rem;box-sizing:border-box;z-index:100}.ui-element{pointer-events:auto;background:#1e2332d9;border:1px solid rgba(255,255,255,.12);border-radius:10px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 4px 16px #0000004d;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.bauhaus-box{background:#1e2332e6;border:1px solid rgba(255,255,255,.15);border-radius:10px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 4px 16px #0000004d}.bauhaus-box h1{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-style:normal;font-weight:700;color:#fffffff2;letter-spacing:.02em}.stats-panel{background:#1e2332e6;border:1px solid rgba(255,255,255,.12);box-shadow:0 2px 12px #0003}.stats-compact{display:flex;gap:1rem;margin-top:.3rem;font-family:Courier New,monospace}.compact{padding:.4rem 1rem;font-size:.85rem}.btn-compact{padding:.55rem 1.1rem;border:1px solid rgba(255,255,255,.12);background:#323c50b3;color:#ffffffe6;cursor:pointer;transition:all .2s ease;font-size:.7rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-weight:500;letter-spacing:.03em;text-transform:uppercase;border-radius:8px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 2px 8px #0003}.btn-compact:hover{background:#3c465fd9;border-color:#ffffff2e;transform:translateY(-1px);box-shadow:0 4px 12px #0000004d}.btn-compact:active{transform:translateY(0);box-shadow:0 2px 6px #0003}.btn-compact.active{background:#3b82f6bf;border-color:#60a5fa80;color:#fff;box-shadow:0 2px 12px #3b82f666}.btn-compact.chaos{background:#dc2626b3;border-color:#ef444480;animation:chaos-pulse 1.5s ease-in-out infinite}@keyframes chaos-pulse{0%,to{box-shadow:0 2px 8px #dc26264d}50%{box-shadow:0 2px 16px #dc262699}}.btn-compact.text{min-width:75px}.chaos-levels{display:flex;gap:.4rem}.btn-level{padding:.35rem .65rem;border:1px solid rgba(239,68,68,.4);background:#1e233299;color:#ef4444e6;cursor:pointer;font-size:.65rem;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-weight:500;border-radius:6px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);transition:all .2s ease}.btn-level:hover{background:#323746cc;border-color:#ef444499}.btn-level.active{background:#dc2626bf;border-color:#ef444499;color:#fff;box-shadow:0 2px 8px #dc262666}.shuffle{background:#22c55eb3;border-color:#4ade8080}.shuffle:hover{background:#22c55ed9;box-shadow:0 4px 12px #22c55e4d}.reset{background:#64748bb3;border-color:#94a3b880}.reset:hover{background:#64748bd9;box-shadow:0 4px 12px #64748b4d}.controls-compact{margin-bottom:1rem;display:flex;justify-content:center}.controls-row{display:flex;gap:.65rem;flex-wrap:wrap;justify-content:center;align-items:center;background:#1e2332d9;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);padding:.8rem 1.4rem;border:1px solid rgba(255,255,255,.08);border-radius:12px;box-shadow:0 4px 20px #0006}.instability-tracker{width:12rem;pointer-events:auto;background:var(--paper-cream);padding:.75rem;border:1px solid rgba(221,161,94,.4);box-shadow:inset 0 2px 4px #582f0e0d}.tracker-label{display:flex;align-items:center;gap:.5rem;margin-bottom:.3rem;font-weight:600;font-size:.75rem;letter-spacing:.05em;text-transform:uppercase;color:var(--ink-medium)}.tracker-bar-container{height:.4rem;background:#582f0e1a;border:1px solid rgba(88,47,14,.15);overflow:hidden}.tracker-bar-fill{height:100%}.tracker-value{text-align:right;font-size:.7rem;margin-top:.25rem;font-family:Courier New,monospace;color:var(--ink-light)}.rotation-preview{position:fixed;top:80px;right:20px;width:100px;background:#14141ee6;border:2px solid rgba(100,100,120,.5);border-radius:8px;padding:10px;z-index:100;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);box-shadow:0 4px 20px #00000080}.preview-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid rgba(100,100,120,.3)}.preview-title{font-size:.65rem;font-weight:700;letter-spacing:.15em;color:#c8c8dccc;text-transform:uppercase}.preview-arrow{font-size:1.4rem;font-weight:700;line-height:1}.preview-grid{display:grid;gap:2px;margin:8px 0;aspect-ratio:1}.preview-cell{background:#3c3c5099;border:1px solid rgba(80,80,100,.4);border-radius:2px;transition:all .3s ease}.preview-cell.highlighted{background:#ffb432b3;border-color:#ffc864cc;box-shadow:0 0 8px #ffb43280}.preview-info{display:flex;justify-content:center;margin:6px 0}.preview-axis{font-size:.85rem;font-weight:600;font-family:Courier New,monospace;color:#c8c8dce6;background:#323246cc;padding:2px 8px;border-radius:4px}.preview-countdown-bar{height:4px;background:#28283ccc;border-radius:2px;overflow:hidden;margin-top:8px}.preview-countdown-fill{height:100%;transition:width .1s linear}.preview-countdown-text{text-align:center;font-size:.75rem;font-weight:700;font-family:Courier New,monospace;margin-top:4px}.tutorial-overlay{position:fixed;top:0;left:0;width:100%;height:100%;height:100dvh;background:#000000bf;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);display:flex;justify-content:center;align-items:center;z-index:1000;padding:var(--safe-area-inset-top) var(--safe-area-inset-right) var(--safe-area-inset-bottom) var(--safe-area-inset-left);box-sizing:border-box}.tutorial-card{background:#1e2332f2;border:1px solid rgba(255,255,255,.12);padding:2.5rem;max-width:540px;width:90%;max-height:80%;max-height:calc(100dvh - 40px - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));overflow-y:auto;border-radius:16px;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 20px 60px #00000080}.tutorial-actions{display:flex;justify-content:space-between;margin-top:1.5rem}.bauhaus-btn{padding:.65rem 1.6rem;border:1px solid rgba(96,165,250,.5);background:#3b82f6bf;color:#fff;cursor:pointer;font-weight:500;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;letter-spacing:.03em;transition:all .2s ease;border-radius:8px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:0 4px 12px #3b82f64d}.bauhaus-btn:hover{background:#3b82f6e6;transform:translateY(-2px);box-shadow:0 6px 16px #3b82f666}.drag-guide-container{display:flex;justify-content:center;align-items:center;gap:1rem;width:120px;height:120px;background:#582f0eb3;pointer-events:none}.guide-arrow{position:absolute;font-size:1.5rem;transition:transform .1s ease;pointer-events:none;color:var(--paper-cream)}.welcome-screen{position:fixed;top:0;right:0;bottom:0;left:0;background:#000;z-index:9999;overflow:hidden}.welcome-canvas{position:absolute;top:0;right:0;bottom:0;left:0}.intro-text-overlay{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;display:flex;flex-direction:column;justify-content:space-between;padding:40px;font-family:Product Sans,Google Sans,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.intro-messages{display:flex;flex-direction:column;gap:12px}.intro-message{color:#ffffffe6;font-size:18px;letter-spacing:.01em;font-style:normal;font-weight:400;transition:opacity .3s ease;text-shadow:0 2px 8px rgba(0,0,0,.5)}.intro-final-card{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;gap:30px;transition:opacity .5s ease;padding-top:80px;height:100%}.intro-title-box{text-align:center;padding:0;border:none;background:transparent;box-shadow:none;position:absolute;top:80px;left:50%;transform:translate(-50%);z-index:1}.intro-title-box h1{font-size:84px;margin:0;background:linear-gradient(135deg,#3b82f6,#60a5fa,#93c5fd);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:700;font-style:normal;letter-spacing:.05em;font-family:Product Sans,Google Sans,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;filter:drop-shadow(0 4px 12px rgba(59,130,246,.4))}.intro-title-box p{margin:16px 0 0;font-size:16px;color:#ffffffd9;letter-spacing:.08em;text-transform:uppercase;font-style:normal;font-weight:400;font-family:Product Sans,Google Sans,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;text-shadow:0 2px 8px rgba(0,0,0,.5)}.intro-instructions{text-align:center;color:#fffc;font-size:16px;letter-spacing:.01em;font-family:Product Sans,Google Sans,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-style:normal;font-weight:400}.intro-instructions p{margin:8px 0;color:#ffffffd9;text-shadow:0 2px 6px rgba(0,0,0,.5)}.skip-intro-btn{position:absolute;top:30px;right:30px;padding:12px 24px;background:#323c50cc;border:1px solid rgba(255,255,255,.15);color:#ffffffe6;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-size:12px;font-weight:500;letter-spacing:.05em;text-transform:uppercase;cursor:pointer;transition:all .2s ease;pointer-events:all;z-index:10000;border-radius:8px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 4px 12px #0000004d}.skip-intro-btn:hover{background:#3c465fe6;border-color:#ffffff40;transform:translateY(-2px);box-shadow:0 6px 16px #0006}.enter-btn{position:absolute;bottom:60px;bottom:calc(60px + var(--safe-area-inset-bottom));left:50%;transform:translate(-50%);padding:18px 60px;background:#3b82f6d9;border:1px solid rgba(96,165,250,.5);color:#fff;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-size:16px;font-weight:600;letter-spacing:.08em;text-transform:uppercase;cursor:pointer;transition:all .2s ease;pointer-events:all;z-index:10000;border-radius:12px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 4px 16px #3b82f666;animation:gentle-pulse 2.5s ease-in-out infinite}.enter-btn:hover{transform:translate(-50%) translateY(-2px);background:#3b82f6f2;box-shadow:0 6px 24px #3b82f699}@keyframes gentle-pulse{0%,to{box-shadow:0 4px 16px #3b82f666}50%{box-shadow:0 6px 24px #3b82f699}}.pedagogical-hint{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;text-align:center;z-index:50}.pedagogical-hint p{font-style:italic;color:var(--ink-light);font-size:14px;opacity:.6;animation:hint-fade 4s ease-in-out infinite}@keyframes hint-fade{0%,to{opacity:.4}50%{opacity:.7}}.manifold-selector{text-align:center;font-size:10px;color:var(--ink-light);letter-spacing:.2em;text-transform:uppercase;opacity:.5;padding-bottom:.5rem}@media (max-width: 1200px){.ui-layer>div:first-child{flex-wrap:wrap;gap:8px}}@media (max-width: 768px){.ui-layer{padding:.5rem;gap:8px}.controls-row{gap:.3rem;padding:.4rem .5rem}.btn-compact{padding:.35rem .5rem;font-size:.55rem;min-width:auto}.btn-compact.text{min-width:50px}.btn-level{padding:.2rem .4rem;font-size:.6rem}.bauhaus-box{padding:.4rem .8rem}.bauhaus-box h1{font-size:20px!important}.stats-compact{gap:.4rem;font-size:.7rem}.ui-layer>div:first-child{flex-direction:column;align-items:stretch;gap:6px}.ui-layer>div:first-child>div{justify-content:center;flex-wrap:wrap;gap:4px}.ui-layer>div:first-child>div:last-child{display:none!important}.ui-layer>div:first-child>div:nth-child(2)>div{padding:3px 8px!important;font-size:9px!important}.stats-panel>div{padding:3px 8px!important}.stats-panel>div>div:first-child{font-size:7px!important}.stats-panel>div>div:last-child{font-size:14px!important}.manifold-selector{font-size:7px!important;padding-bottom:.3rem}.controls-compact{padding-bottom:var(--safe-area-inset-bottom)}.tutorial-card{padding:1.5rem;max-height:calc(100dvh - 60px - var(--safe-area-inset-top) - var(--safe-area-inset-bottom))!important}.enter-btn{bottom:calc(40px + var(--safe-area-inset-bottom))!important;padding:14px 40px;font-size:14px}}.ui-layer *{-webkit-user-select:none;user-select:none}.net-panel{position:fixed;top:0;right:0;height:100%;height:100dvh;width:320px;background:#1e2332eb;border-left:1px solid rgba(255,255,255,.12);-webkit-backdrop-filter:blur(16px);backdrop-filter:blur(16px);z-index:200;display:flex;flex-direction:column;padding:16px;box-sizing:border-box;transform:translate(100%);transition:transform .3s cubic-bezier(.4,0,.2,1);box-shadow:-4px 0 24px #0006}.net-panel.open{transform:translate(0)}.net-panel-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.1)}.net-panel-title{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;font-size:13px;font-weight:600;letter-spacing:.12em;text-transform:uppercase;color:#ffffffd9}.net-close-btn{background:#ffffff14;border:1px solid rgba(255,255,255,.1);color:#ffffffb3;width:28px;height:28px;border-radius:6px;cursor:pointer;font-size:18px;line-height:1;display:flex;align-items:center;justify-content:center;transition:all .15s ease}.net-close-btn:hover{background:#ffffff26;color:#fff}.net-cross{display:grid;gap:6px;flex:1;align-content:center;justify-content:center}.net-face{display:grid;gap:2px;position:relative;padding:2px;background:#ffffff0a;border-radius:4px;border:1px solid rgba(255,255,255,.06)}.net-face-label{position:absolute;top:3px;left:5px;font-family:Courier New,monospace;font-size:9px;font-weight:700;color:#ffffff59;pointer-events:none;z-index:1}.net-cell{aspect-ratio:1;border-radius:3px;border:1px solid rgba(0,0,0,.3);transition:transform .12s ease,filter .12s ease;position:relative;min-width:0}.net-cell.clickable{cursor:pointer}.net-cell.clickable:hover{transform:scale(1.08);filter:brightness(1.2);z-index:2;box-shadow:0 0 8px #fff3}.net-cell.clickable:active{transform:scale(.95)}.net-flip-dot{position:absolute;top:3px;right:3px;width:5px;height:5px;border-radius:50%;background:#fffc;box-shadow:0 0 4px #ffffff80;pointer-events:none}@media (max-width: 768px){.net-panel{width:260px;padding:12px}.net-cross{gap:4px}.net-face{gap:1px}}.settings-overlay{position:fixed;top:0;left:0;right:0;bottom:0;height:100dvh;background:#000000bf;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;z-index:1000;padding:env(safe-area-inset-top,0px) env(safe-area-inset-right,0px) env(safe-area-inset-bottom,0px) env(safe-area-inset-left,0px);box-sizing:border-box}.settings-panel{background:#1e2332f2;border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:0;max-width:480px;width:90%;max-height:calc(100dvh - 60px - env(safe-area-inset-top,0px) - env(safe-area-inset-bottom,0px));overflow-y:auto;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 20px 60px #00000080}.settings-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid rgba(255,255,255,.1)}.settings-title{margin:0;font-size:18px;font-weight:600;color:#fffffff2;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;letter-spacing:.02em}.settings-close-btn{background:#ffffff14;border:1px solid rgba(255,255,255,.1);color:#ffffffb3;width:32px;height:32px;border-radius:8px;cursor:pointer;font-size:20px;line-height:1;display:flex;align-items:center;justify-content:center;transition:all .15s ease}.settings-close-btn:hover{background:#ffffff26;color:#fff}.settings-body{padding:16px 24px 24px}.settings-section{margin-bottom:20px}.settings-section:last-child{margin-bottom:0}.settings-section-title{margin:0 0 10px;font-size:11px;font-weight:600;color:#ffffff80;text-transform:uppercase;letter-spacing:.1em;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.settings-radio-group{display:flex;flex-direction:column;gap:4px}.settings-radio{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;cursor:pointer;transition:background .15s ease;background:transparent}.settings-radio:hover{background:#ffffff0d}.settings-radio.active{background:#3b82f626}.settings-radio input[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-radius:50%;flex-shrink:0;position:relative;cursor:pointer}.settings-radio input[type=radio]:checked{border-color:#3b82f6}.settings-radio input[type=radio]:checked:after{content:"";position:absolute;top:3px;left:3px;width:6px;height:6px;border-radius:50%;background:#3b82f6}.settings-radio-label{font-size:13px;color:#ffffffd9;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;flex:1}.scheme-preview{display:flex;gap:3px}.scheme-dot{width:14px;height:14px;border-radius:3px;border:1px solid rgba(0,0,0,.3)}.image-upload-area{margin-bottom:12px}.image-upload-btn{width:100%;padding:10px;border:1px dashed rgba(255,255,255,.2);border-radius:8px;background:#ffffff0a;color:#ffffffb3;font-size:12px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;cursor:pointer;transition:all .15s ease;letter-spacing:.03em}.image-upload-btn:hover{background:#3b82f626;border-color:#3b82f666;color:#ffffffe6}.image-preview-row{display:flex;align-items:center;gap:10px;margin-top:8px;padding:8px;border-radius:8px;background:#ffffff0a}.image-preview-thumb{width:40px;height:40px;border-radius:6px;object-fit:cover;border:1px solid rgba(255,255,255,.12)}.face-texture-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.face-texture-item{display:flex;flex-direction:column;align-items:center;gap:4px}.face-texture-upload{width:56px;height:56px;border:1px dashed rgba(255,255,255,.2);border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s ease;background:#ffffff08}.face-texture-upload:hover{background:#3b82f61a;border-color:#3b82f666}.face-texture-plus{font-size:20px;color:#ffffff4d;line-height:1}.face-texture-preview{width:56px;height:56px;border-radius:8px;overflow:hidden;position:relative;cursor:pointer;border:1px solid rgba(255,255,255,.15)}.face-texture-thumb{width:100%;height:100%;object-fit:cover}.face-texture-remove{position:absolute;top:2px;right:2px;width:18px;height:18px;border-radius:50%;background:#000000b3;border:none;color:#fffc;font-size:12px;line-height:1;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .15s ease}.face-texture-preview:hover .face-texture-remove{opacity:1}.settings-hint{margin:0 0 10px;font-size:11px;color:#fff6;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.color-picker-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.color-picker-item{display:flex;flex-direction:column;align-items:center;gap:4px}.color-input{width:48px;height:32px;border:1px solid rgba(255,255,255,.15);border-radius:6px;cursor:pointer;background:transparent;padding:2px}.color-input::-webkit-color-swatch-wrapper{padding:0}.color-input::-webkit-color-swatch{border:none;border-radius:4px}.color-input::-moz-color-swatch{border:none;border-radius:4px}.color-picker-label{font-size:10px;color:#ffffff80;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;text-transform:uppercase;letter-spacing:.05em}.settings-toggles{display:flex;flex-direction:column;gap:4px}.settings-toggle-row{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;border-radius:8px;cursor:pointer;transition:background .15s ease}.settings-toggle-row:hover{background:#ffffff0d}.toggle-label{font-size:13px;color:#ffffffd9;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.toggle-switch{width:40px;height:22px;border-radius:11px;background:#ffffff26;position:relative;cursor:pointer;transition:background .2s ease;flex-shrink:0}.toggle-switch.on{background:#3b82f6cc}.toggle-knob{width:18px;height:18px;border-radius:50%;background:#fff;position:absolute;top:2px;left:2px;transition:transform .2s ease;box-shadow:0 1px 3px #0000004d}.toggle-switch.on .toggle-knob{transform:translate(18px)}.bg-dark{background:#0a0a0a!important}.bg-midnight{background:linear-gradient(180deg,#0a0e1a,#0f1b3d,#0a0e1a)!important}@keyframes pulse{0%,to{opacity:1;transform:scale(1)}50%{opacity:.9;transform:scale(1.02)}}@keyframes victory-glow{0%,to{box-shadow:0 0 10px #eab3084d}50%{box-shadow:0 0 20px #eab30899}}
